/*!
 * Copyright (c) 2021 Momo Bassit.
 * Licensed under the MIT License (MIT)
 * https://github.com/mdbassit/Coloris
 */
!function(p,g,s){var y,b,d,l,m,E,w,L,n,k,r,f,h,a=g.createElement("canvas").getContext("2d"),o={r:0,g:0,b:0,h:0,s:0,v:0,a:1},x={el:"[data-coloris]",parent:null,theme:"light",wrap:!0,margin:2,format:"hex",swatches:[],alpha:!0,clearButton:{show:!1,label:"Clear"},a11y:{open:"Open color picker",close:"Close color picker",marker:"Saturation: {s}. Brightness: {v}.",hueSlider:"Hue slider",alphaSlider:"Opacity slider",input:"Color value field",swatch:"Color swatch",instruction:"Saturation and brightness selector. Use up, down, left and right arrow keys to select."}};function t(s){var u,p,d,f,h,v;if("object"==typeof s)for(var e in s)!function(e){switch(e){case"el":T(s.el),!1!==s.wrap&&S(s.el);break;case"parent":x.parent=g.querySelector(null!==(u=s.parent)&&void 0!==u?u:""),x.parent&&x.parent.appendChild(y);break;case"theme":y.className="clr-picker clr-"+(null!==(p=s.theme)&&void 0!==p?p:"light").split("-").join(" clr-");break;case"margin":s.margin=parseInt(String(null!==(d=s.margin)&&void 0!==d?d:0)),x.margin=(isNaN(s.margin)?x:s).margin;break;case"wrap":s.el&&s.wrap&&S(s.el);break;case"format":x.format=null!==(f=s.format)&&void 0!==f?f:"hex";break;case"swatches":var a;Array.isArray(s.swatches)&&(a=[],s.swatches.forEach(function(e,t){a.push('<button id="clr-swatch-'+t+'" aria-labelledby="clr-swatch-label clr-swatch-'+t+'" style="color: '+e+';">'+e+"</button>")}),!a.length||(l=B("clr-swatches"))&&(l.innerHTML="<div>"+a.join("")+"</div>"));break;case"alpha":x.alpha=!!s.alpha,y.setAttribute("data-alpha",String(x.alpha));break;case"clearButton":var t="none";null!==(h=s.clearButton)&&void 0!==h&&h.show&&(t="block"),null!==(v=s.clearButton)&&void 0!==v&&v.label&&(w.innerHTML=s.clearButton.label),w.style.display=t;break;case"a11y":var l,n=s.a11y,r=!1;if("object"==typeof n)for(var o=0,i=Object.keys(n);o<i.length;o++){var c=i[o];n[c]&&x.a11y[c]&&(x.a11y[c]=n[c],r=!0)}r&&(l=B("clr-open-label"),t=B("clr-swatch-label"),l&&(l.innerHTML=x.a11y.open),t&&(t.innerHTML=x.a11y.swatch),m.setAttribute("aria-label",x.a11y.close),L.setAttribute("aria-label",x.a11y.hueSlider),k.setAttribute("aria-label",x.a11y.alphaSlider),E.setAttribute("aria-label",x.a11y.input),b.setAttribute("aria-label",x.a11y.instruction))}}(e)}function T(e){I(g,"click",e,function(e){var t,a,l,n,r,o,i,c,s,u;e.target instanceof HTMLInputElement&&(t=x.parent,a=e.target.getBoundingClientRect(),l=p.scrollY,n={left:!1,top:!1},u={x:0,y:0},r=a.x,o=l+a.y+a.height+x.margin,f=e.target,h=f.value,y.classList.add("clr-open"),i=y.offsetWidth,c=y.offsetHeight,t?(s=p.getComputedStyle(t),e=parseFloat(s.marginTop),s=parseFloat(s.borderTopWidth),(u=t.getBoundingClientRect()).y+=s+l,r-=u.x,o-=u.y,r+i>t.clientWidth&&(r+=a.width-i,n.left=!0),o+c>t.clientHeight-e&&(o-=a.height+c+2*x.margin,n.top=!0),o+=t.scrollTop):(r+i>g.documentElement.clientWidth&&(r+=a.width-i,n.left=!0),o+c-l>g.documentElement.clientHeight&&(o=l+a.y-c-x.margin,n.top=!0)),y.classList.toggle("clr-left",n.left),y.classList.toggle("clr-top",n.top),y.style.left=r+"px",y.style.top=o+"px",d={width:b.offsetWidth,height:b.offsetHeight,x:y.offsetLeft+b.offsetLeft+u.x,y:y.offsetTop+b.offsetTop+u.y},v(f.value),E.focus({preventScroll:!0}))}),I(g,"input",e,function(e){var t;e.target instanceof HTMLInputElement&&((t=e.target.parentNode)instanceof HTMLElement&&t.classList.contains("clr-field")&&(t.style.color=e.target.value))})}function S(e){g.querySelectorAll(e).forEach(function(e){var t,a=e.parentNode;e instanceof HTMLInputElement&&a instanceof HTMLElement&&!a.classList.contains("clr-field")&&((t=g.createElement("div")).innerHTML='<button aria-labelledby="clr-open-label"></button>',a.insertBefore(t,e),t.setAttribute("class","clr-field"),t.style.color=e.value,t.appendChild(e))})}function i(e){f&&(e&&h!==f.value&&(f.value=h,f.dispatchEvent(new Event("input",{bubbles:!0}))),h!==f.value&&f.dispatchEvent(new Event("change",{bubbles:!0})),y.classList.remove("clr-open"),f.focus({preventScroll:!0}),f=null)}function v(e){var t=function(e){var t;a.fillStyle="#000",a.fillStyle=e,t=(t=/^((rgba)|rgb)[\D]+([\d.]+)[\D]+([\d.]+)[\D]+([\d.]+)[\D]*?([\d.]+|$)/i.exec(a.fillStyle))?{r:parseFloat(t[3]),g:parseFloat(t[4]),b:parseFloat(t[5]),a:parseFloat(t[6])}:(t=(null!==(e=a.fillStyle.replace("#","").match(/.{2}/g))&&void 0!==e?e:[]).map(function(e){return parseInt(e,16)}),{r:t[0],g:t[1],b:t[2],a:1});return t}(e),e=function(e){var t=e.r/255,a=e.g/255,l=e.b/255,n=s.max(t,a,l),r=s.min(t,a,l),o=n-r,i=n,c=0,r=0;o&&(n===t&&(c=(a-l)/o),n===a&&(c=2+(l-t)/o),n===l&&(c=4+(t-a)/o),n&&(r=o/n));return{h:(c=s.floor(60*c))<0?c+360:c,s:s.round(100*r),v:s.round(100*i),a:e.a}}(t);H(e.s,e.v),M(t,e),L.value=String(e.h),y.style.color="hsl("+e.h+", 100%, 50%)",n.style.left=e.h/360*100+"%",l.style.left=d.width*e.s/100+"px",l.style.top=d.height-d.height*e.v/100+"px",k.value=String(100*e.a),r.style.left=100*e.a+"%"}function c(e){f&&(f.value=void 0!==e?String(e):E.value,f.dispatchEvent(new Event("input",{bubbles:!0})))}function u(e,t){e={h:parseFloat(L.value),s:e/d.width*100,v:100-t/d.height*100,a:parseFloat(k.value)/100},t=function(e){var t=e.s/100,a=e.v/100,l=t*a,n=e.h/60,r=l*(1-s.abs(n%2-1)),o=a-l;l+=o,r+=o;t=s.floor(n)%6,a=[l,r,o,o,r,l][t],n=[r,l,l,r,o,o][t],t=[o,o,r,l,l,r][t];return{r:s.round(255*a),g:s.round(255*n),b:s.round(255*t),a:e.a}}(e);H(e.s,e.v),M(t,e),c()}function H(e,t){var a=x.a11y.marker;a=(a=a.replace("{s}",e.toFixed(1))).replace("{v}",t.toFixed(1)),l.setAttribute("aria-label",a)}function e(e){var t,a;("function"==typeof TouchEvent&&e instanceof TouchEvent||e instanceof MouseEvent)&&(t=(a=(t=e)instanceof MouseEvent?{pageX:t.pageX,pageY:t.pageY}:{pageX:t.changedTouches[0].pageX,pageY:t.changedTouches[0].pageY}).pageX-d.x,a=a.pageY-d.y,x.parent&&(a+=x.parent.scrollTop),t=t<0?0:t>d.width?d.width:t,a=a<0?0:a>d.height?d.height:a,l.style.left=t+"px",l.style.top=a+"px",u(t,a),e.preventDefault(),e.stopPropagation())}function M(e,t){void 0===t&&(t={}),Object.assign(o,e),Object.assign(o,t);var a,e=function(e){var t=e.r.toString(16),a=e.g.toString(16),l=e.b.toString(16),n="";e.r<16&&(t="0"+t);e.g<16&&(a="0"+a);e.b<16&&(l="0"+l);x.alpha&&e.a<1&&(e=255*e.a|0,n=e.toString(16),e<16&&(n="0"+n));return"#"+t+a+l+n}(o),t=e.substring(0,7);switch(l.style.color=t,r.parentNode instanceof HTMLElement&&(r.parentNode.style.color=t),r.style.color=e,m.style.color=e,E.value=e,b.style.display="none",b.offsetHeight,b.style.display="",r.nextElementSibling instanceof HTMLElement&&(r.nextElementSibling.style.display="none",r.nextElementSibling.offsetHeight,r.nextElementSibling.style.display=""),x.format){case"mixed":if(1===o.a)break;case"rgb":E.value=(a=o,x.alpha&&1!==a.a?"rgba("+a.r+", "+a.g+", "+a.b+", "+a.a+")":"rgb("+a.r+", "+a.g+", "+a.b+")");break;case"hsl":E.value=(a=function(e){var t,a=e.v/100,l=a*(1-e.s/100/2);0<l&&l<1&&(t=s.round((a-l)/s.min(l,1-l)*100));return{h:e.h,s:t||0,l:s.round(100*l),a:e.a}}(o),x.alpha&&1!==a.a?"hsla("+a.h+", "+a.s+"%, "+a.l+"%, "+a.a+")":"hsl("+a.h+", "+a.s+"%, "+a.l+"%)")}}function A(){var e=parseFloat(L.value),t=parseFloat(l.style.left.replace("px","")),a=parseFloat(l.style.top.replace("px",""));y.style.color="hsl("+e+", 100%, 50%)",n.style.left=e/360*100+"%",u(t,a)}function F(){var e=parseFloat(k.value)/100;r.style.left=100*e+"%",M({a:e}),c()}function B(e){return g.getElementById(e)}function C(e,t){var a=g.getElementById(e);if(!a)throw new Error("Expected to find element with ID "+e+", but no such element exists.");if(!("function"==typeof t&&a instanceof t))throw new Error("Expected element with "+e+" to be "+t+", but got "+a+".");return a}function N(e,t,a){e.addEventListener(t,a)}function I(e,t,a,l){var n=Element.prototype.matches||Element.prototype.msMatchesSelector;e.addEventListener(t,function(e){n.call(e.target,a)&&l.call(e.target,e)})}function D(e,t){"loading"!==g.readyState?e.apply(void 0,t):g.addEventListener("DOMContentLoaded",function(){e.apply(void 0,t)})}void 0!==NodeList&&NodeList.prototype&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=function(e,t){for(var a=0;a<this.length;a+=1){var l=this.item(a);l&&e.call(t,l,a,this)}});function j(e){D(function(){e&&("string"==typeof e?T:t)(e)},[])}j.set=function(e){return D(t,[e])},j.wrap=function(e){return D(S,[e])},j.close=function(){return D(i,[])},p.Coloris=j,D(function(){(y=g.createElement("div")).setAttribute("id","clr-picker"),y.className="clr-picker",y.innerHTML='<input id="clr-color-value" class="clr-color" type="text" value="" aria-label="'+x.a11y.input+'"><div id="clr-color-area" class="clr-gradient" role="application" aria-label="'+x.a11y.instruction+'"><div id="clr-color-marker" class="clr-marker" tabindex="0"></div></div><div class="clr-hue"><input id="clr-hue-slider" type="range" min="0" max="360" step="1" aria-label="'+x.a11y.hueSlider+'"><div id="clr-hue-marker"></div></div><div class="clr-alpha"><input id="clr-alpha-slider" type="range" min="0" max="100" step="1" aria-label="'+x.a11y.alphaSlider+'"><div id="clr-alpha-marker"></div><span></span></div><div id="clr-swatches" class="clr-swatches"></div><button id="clr-clear" class="clr-clear">'+x.clearButton.label+'</button><button id="clr-color-preview" class="clr-preview" aria-label="'+x.a11y.close+'"></button><span id="clr-open-label" hidden>'+x.a11y.open+'</span><span id="clr-swatch-label" hidden>'+x.a11y.swatch+"</span>",g.body.appendChild(y),b=C("clr-color-area",HTMLElement),l=C("clr-color-marker",HTMLElement),w=C("clr-clear",HTMLButtonElement),m=C("clr-color-preview",HTMLElement),E=C("clr-color-value",HTMLInputElement),L=C("clr-hue-slider",HTMLInputElement),n=C("clr-hue-marker",HTMLElement),k=C("clr-alpha-slider",HTMLInputElement),r=C("clr-alpha-marker",HTMLElement),T(x.el),S(x.el),N(y,"mousedown",function(e){y.classList.remove("clr-keyboard-nav"),e.stopPropagation()}),N(b,"mousedown",function(){N(g,"mousemove",e)}),N(b,"touchstart",function(){g.addEventListener("touchmove",e,{passive:!1})}),N(l,"mousedown",function(){N(g,"mousemove",e)}),N(l,"touchstart",function(){g.addEventListener("touchmove",e,{passive:!1})}),N(E,"change",function(){v(E.value),c()}),N(w,"click",function(){c(""),i()}),N(m,"click",function(){c(),i()}),I(y,"click",".clr-swatches button",function(e){e.target instanceof HTMLElement&&(v(e.target.style.color),c())}),N(g,"mouseup",function(){g.removeEventListener("mousemove",e)}),N(g,"touchend",function(){g.removeEventListener("touchmove",e)}),N(g,"mousedown",function(){y.classList.remove("clr-keyboard-nav"),i()}),N(g,"keydown",function(e){e instanceof KeyboardEvent&&("Escape"===e.key?i(!0):"Tab"===e.key&&y.classList.add("clr-keyboard-nav"))}),I(g,"click",".clr-field button",function(e){var t;e.target instanceof Element&&null!==(t=e.target.nextElementSibling)&&void 0!==t&&t.dispatchEvent(new Event("click",{bubbles:!0}))}),N(l,"keydown",function(e){var t;e instanceof KeyboardEvent&&(t={ArrowUp:[0,-1],ArrowDown:[0,1],ArrowLeft:[-1,0],ArrowRight:[1,0]},-1!==Object.keys(t).indexOf(e.key)&&(function(e,t){e=parseFloat(l.style.left.replace("px",""))+e,t=parseFloat(l.style.top.replace("px",""))+t,l.style.left=e+"px",l.style.top=t+"px",u(e,t)}.apply(void 0,t[e.key]),e.preventDefault()))}),N(b,"click",e),N(L,"input",A),N(k,"input",F)},[])}(window,document,Math);